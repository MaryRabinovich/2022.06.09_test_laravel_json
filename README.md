# Задача

Развернуть проект на Yii/Laravel или любом другом PHP-фреймворке (который реализован на подходе MVC) и сделать скрипт, который будет принимать на вход данные в формате JSON и формировать из них маркированный HTML-список с поддержкой разворачивания/сворачивания отдельных элементов. Элементы списка должны включать в себя название, тип объекта и значение в случае конца иерархии объектов.

Скрипт должен поддерживать следующие параметры (как через GET, так и через POST):
1) background - ссылка на фон (как с http/https, так и без) или параметры фона в формате RGB (например "(0;15;25)" или "(0,1,3)", скобки будут в любом случае)
2) depth - глубина изначального разворачивания списка (от 1 и выше и в том числе max)

Из библиотек разрешено использовать только jQuery.

Весь проект и ход выполнения заданий нужно выложить в репозитории на GitHub. Помимо этого в readme.md нужно указать данные конфига для Nginx для запуска проекта и реализации доступа на сайт по логину и паролю.

# Решение

Проект реализован на Laravel 8, без javascript и его библиотек. Сворачивание и разворачивание элементов реализовано с помощью html тега details.

Основной маршрут - '/', доступный одновременно и GET, и POST запросами.

Везде ожидается обязательный параметр 'json'. Значением с этим ключом должен быть валидный джейсон.

Кроме того, допустимы не обязательные параметры 'depth', 'background' и 'color'. Depth должен быть числом, background и color - строками. Параметр color отвечает за цвет текста на экране и обрабатывается как англоязычное название цвета (white, red, blue...).

Проверка введённых данных производится классом DeployJsonRequest (файл app/Http/Requests/DeployJsonRequest.php).

Background обрабатывается как абсолютная ссылка на фоновую картинку, относительная ссылка на картинку в папке /public/img, или тройка rgb в скобках через запятую. Обработка производится в контроллере компонента DeployJsonBackground (файл app/View/Components/DeployJsonBackground.php).

Компонент DeployJsonContainer (файл app/View/Components/DeployJsonBackground.php) разбирает $request на базовые параметры (цвет шрифта, цвет фона, уровень раскрытия джейсона и сам джейсон) и рендерит шаблон контейнер (файл resources/views/components/deploy-json-container.blade.php). 

В шаблоне контейнере на верхнем уровне выставляется цвет шрифта. Кроме того, из него отдельно вызываются компонент для отрисовки фона DeployJsonBackground и компонент для печати джейсона DeployJsonSwitcher.

Класс DeployJsonSwitcher (файл app/View/Components/DeployJsonSwitcher.php) проверяет тип ноды, и выбирает шаблон из двух вариантов: печать одной строки или печать ноды типа массива или объекта. В обоих шаблонах внешние теги - "элемент списка". 

Внутри шаблона для печати ноды типа массива или объекта создаётся внутренний список следущего уровня вложенности и каждый его элемент рекурсивно вызывает DeployJsonSwitcher.

Стили определяются как изнутри шаблонов, так и в отдельном css файле /resources/css/app.css . В частности, в этом файле задаётся opacity для фоновой картинки (класс 'deploy_json__background'). 

Проект снабжён тестами (папка /tests/Features/DeployJson). Для запуска тестов перейдите в папку проекта и введите команду 'php artisan test'.

# Nginx

Проверим защищённость соединения. На незащищённом http заголовки с логином и паролем будут передаваться открыто, то есть, возможна утечка данных.

Для создания логина с паролем (на линуксе) введём инструкцию

$ sudo htpasswd -c /etc/nginx/conf.d/.htpasswd _логин_

В диалоге введём пароль:

New password: 

Re-type new password: 

Adding password for user _логин_

Таким образом будет создан файл /etc/nginx/conf.d/.htpasswd с захешированным паролем по ключу _логин_.

Кроме того, добавим в конфигурационный файл для нашего сайта строчки, отвечающие за вывод на экран формы логина-пароля:

auth_basic "Enter your password!";

auth_basic_user_file /etc/nginx/conf.d/.htpasswd;
